{# template de l'objet ODInput #}

{% set objClass = "gotObject "~gotBootstrap(objet.widthBT) %}
{% set labelClass = "" %}
{% set inputClass = "" %}

{% if objet.type != "hidden" and objet.errMessage is defined and objet.errMessage is not empty %}
    {% set objClass   = objClass ~ " has-error " %}
    {% set labelClass = "control-label " %}
    {% set inputClass = " form-control " %}
{% endif %}
{% set labelWidth = "" %}
{% set inputWidth = "" %}
{% for key, value in objet.labelWidthBT %}
    {% if (substr(key, 0, 1) == 'l') %}
        {% set cle = 'w' ~ substr(key, 1, 1) %}
        {% set labelWidth = labelWidth ~ cle ~ value ~ ":" %}
    {% elseif (substr(key, 0, 1) == 'i') %}
        {% set cle = 'w' ~ substr(key, 1, 1) %}
        {% set inputWidth = inputWidth ~ cle ~ value ~ ":" %}
    {% endif %}
{% endfor %}
{% set labelClass = labelClass ~ gotBootstrap(substr(labelWidth, 0, labelWidth|length - 1)) %}
{% set inputClass = inputClass ~ gotBootstrap(inputWidth) %}
{% if (objet.size is not empty) %} {% set inputClass = "" %} {% endif %}
{% if objet.classes is not empty %}
    {% set inputClass = inputClass ~ " " ~ objet.classes %}
{% endif %}

<div id="{{ objet.id }}" data-objet="{{ objet.object }}"
        {% if objet.form is not empty %} data-form="{{ objet.form }}" {% endif %}
        {% if objClass is not empty %} class="{{ objClass }}" {% endif %}
        {% if objet.event is not empty %}
            {% for evt, callback in objet.event %}
                {% set allEvt = allEvt ~ evt ~ ", " %}
                data-{{ evt }}-class ="{{ callback.class }}"
                data-{{ evt }}-method ="{{ callback.method }}"
                data-{{ evt }}-stopEvt ="{{ callback.stopEvent }}"
            {% endfor %}
            data-evt="{{ allEvt | slice(0, allEvt|length - 2) }}"
        {% endif %}
>

    <style>
        #{{ objet.id }} {
            display: {{ objet.display }};
        {% if objet.style is not empty %}
            {{ objet.style | raw }}
        {% endif %}
        }

        {% if objet.infoBulle.title is not empty and objet.infoBulle.css is not empty and objet.erreur.libel is empty %}
        {% set id = objet.id ~ " input" %}
        {% set type = objet.infoBulle.type %}
        {% set css = objet.infoBulle.css %}
        {% set placement = objet.infoBulle.placement %}
        {% include 'graphic-object-templating/oobject/infoBulle.css.twig'  with {"id": id, "type": type, "css": css, "placement": placement } %}
        {% elseif objet.erreur.libel is not empty and objet.type != "hidden" %}
        {% set erreur = objet.erreur %}
        {% set id = objet.id ~ " input" %}
        {% set type = 'tooltip' %}
        {% set css = "background-color: #" ~ erreur.backgroundColor ~ ";color: #" ~ erreur.color ~ ';' %}
        {% set placement = objet.infoBulle.placement %}
        {% include 'graphic-object-templating/oobject/infoBulle.css.twig'  with {"id": id, "type": type, "css": css, "placement": placement } %}

        #{{ id }} {
            border:  solid 2px #{{ erreur.color }};
        }
        {% endif %}

        {% if objet.wide > 0 %}
        #{{ objet.id }} input {
            width: {{ objet.wide }};
        }
        {% endif %}

    </style>

    {%  if objet.label is not empty or objet.icon is not empty %}
        <label for="{{ objet.id }}_{{ objet.type }}"
        {% if labelClass is not empty %} class="{{ labelClass }}" {% endif %}
        >
            {% if objet.icon is defined %}
                <i class="{{ objet.icon }}"></i>
            {% endif %}
            {{ translate(objet.label) }}
        </label>
    {% endif %}
    <input id="{{ objet.id }}_{{ objet.type }}" name="{{ objet.name }}" type="{{ objet.type }}"
        {% if objet.value is not empty %} value="{{ objet.value }}" {% endif %}
        {% if objet.size is not empty %} size="{{ objet.size }}" {% endif %}
        {% if objet.maxlength is not empty %} maxlength="{{ objet.maxlength }}" {% endif %}
        {% if objet.state == false %} disabled {% endif %}
        {% if inputClass is not empty %} class="{{ inputClass }}" {% endif %}
        {% if objet.placeholder is not empty %} placeholder="{{ objet.placeholder }}" {% endif %}
        {% if objet.infoBulle is not empty or (objet.erreur.libel is empty) %}
            {%  set infoBulle = objet.infoBulle %}
        {% endif %}
        {% if objet.type != "hidden" and objet.erreur.libel is not empty %}
            {% set infoBulle = objet.infoBulle %}
            {% set erreur = objet.erreur %}
            {% set infoBulle =
            infoBulle | update({'title': erreur.libel, 'content': '', 'type': 'tooltip'}) %}
        {% endif %}
        {% if infoBulle is defined and infoBulle is not empty %}
            {% include 'graphic-object-templating/oobject/infoBulle.twig'  with infoBulle %}
        {% endif %}
    />
    {% if objet.type != "hidden" %}
    <div class="control-group error">{{ objet.errMessage }}</div>
    {% endif %}

    {% if objet.type != "hidden" %}
        {% if objet.event is defined and objet.event is not empty %}
            <script id="{{ objet.id }}Script">
                $('document').ready(
                    {% if objet.event is not empty %}
                        {% set events = objet.event %}
                        {% include 'graphic-object-templating/oobject/event.js.twig' with events %}
                    {% endif %}
                );
            </script>
        {% endif %}
    {% endif %}

    {% if objet.infoBulle is not empty %}
        {%  set type = objet.infoBulle.type %}
        {%  set id = objet.id ~ "_" ~ objet.type %}
        {% include 'graphic-object-templating/oobject/infoBulle.js.twig'  with {'id':id, 'type':type} %}
    {% endif %}

</div>
